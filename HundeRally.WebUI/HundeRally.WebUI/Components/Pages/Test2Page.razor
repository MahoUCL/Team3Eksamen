@inject ImageService ImageService

@page "/test2"
@using System.Text.Json
@using Domain.Entity
@using Domain.Services
@using Microsoft.AspNetCore.Components.Web
@using Microsoft.JSInterop

<div>
    <table class="grid">
        @for (int i = 0; i < 22; i++)
        {
            <tr>
                @for (int j = 0; j < 38; j++)
                {
                    var cellId = i * 38 + j;
                    <td class="cell">
                        <button @onclick="() => SelectCell(cellId)" class="select-button"></button>
                    </td>
                }
            </tr>
        }
    </table>
</div>

<div id="gallery" style="display: none;">
    @foreach (var imagePath in imagePaths)
    {
        <img src="@($"~/images/{imagePath}.png")" alt="Image" @onclick="() => SelectImage(imagePath)" />
    }
</div>

@code {
    private List<string> imagePaths = new List<string>();
    private int? selectedCell;

    private void SelectCell(int cellId)
    {
        selectedCell = cellId;
        ShowGallery();
    }

    private void ShowGallery()
    {
        // Load image paths from wwwroot/images directory
        imagePaths = LoadImagePaths();
        // JSRuntime.InvokeVoidAsync("eval", "document.getElementById('gallery').style.display = 'block';");

    }

    private void SelectImage(string imageName)
    {
        if (selectedCell.HasValue)
        {
            imagePaths[selectedCell.Value] = imageName;
            selectedCell = null;
        }
    }

    private List<string> LoadImagePaths()
    {
        // Logic to load image paths from wwwroot/images directory
        // Replace this with your own implementation
        return ImageService.GetImageNames().ToList();
    }
}

<style>
    .grid {
        width: 90vw;
        height: 90vh;
        background-image: url('/Bane/image1.jpg');
        background-size: contain;
        background-repeat: no-repeat;
    }

    .cell {
        position: relative;
    }

    .select-button {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        transition: opacity 0.3s;
    }

    .cell:hover .select-button {
        opacity: 1;
    }
</style>